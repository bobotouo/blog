import P from"./CZAyMvhA.js";import{u as j,_ as N}from"./5iZSLYQR.js";import{j as A,M as L,N as R,K as Y,O as F,c as a,a as o,t as c,u as t,H as i,F as w,G as k,k as H,b as S,L as T,o as s,P as V,f as q,_ as E}from"./Og3GdUtk.js";import{u as O}from"./DSxBcGl3.js";import{u as z,a as G}from"./Bt2jnTCr.js";import{q as I}from"./CqTP0jWH.js";import{u as K}from"./Dx39jrq7.js";import"./BkPylkhG.js";import"./BSZFgSs5.js";import"./B8IaAclc.js";import"./nfukM5za.js";import"./BlgqvkKC.js";import"./CURaniLi.js";const U={class:"max-w-4xl mx-auto py-10 px-6"},J={class:"mt-6 rounded-3xl border border-white/10 bg-white/5 backdrop-blur-xl p-8 md:p-10 shadow-[0_30px_80px_rgba(0,0,0,0.45)]"},Q={class:"text-4xl md:text-5xl font-semibold text-white mb-4"},W={class:"text-sm text-white/60 mb-6 flex flex-wrap items-center gap-4"},X={key:0,class:"text-white/40"},Z={key:1,class:"text-white/40"},tt={key:2,class:"text-white/40"},et={key:0,class:"text-white/70 mb-6"},st={key:1,class:"grid gap-3 sm:grid-cols-2 mb-8"},at=["src","loading","fetchpriority"],ot={key:2,class:"flex flex-wrap gap-2 mb-8"},nt={class:"prose prose-invert max-w-none"},rt=["innerHTML"],ct={class:"mt-10"},it=A({__name:"[...slug]",async setup(lt){let l,_;const u=L(),v=R(),C=()=>{window.history.length>1?v.back():V("/snapshots")},h=T().public.baseUrl||"/",x=h.replace(/\/$/,"")+u.path,{views:f}=O(x),{count:g}=j(x),b=Array.isArray(u.params.slug)?u.params.slug.join("/"):u.params.slug,p=`/snapshots/${b}`,$=h.replace(/\/$/,""),{data:e}=([l,_]=Y(async()=>z(`snapshot-${p}`,async()=>{const r=G(`snapshot-${p}`).data.value;if(r)return r;try{return await I(p).findOne()}catch{return await $fetch(`${$}/snapshots/${b}.json`).catch(()=>null)??null}},{getCachedData:()=>{}})),l=await l,_(),l),y=q(()=>{const n=e.value?.body;return typeof n=="string"?n:null});if(!e.value)throw F({statusCode:404,statusMessage:"Page not found"});function D(r){return r?K(r,"YYYY-MM-DD").value:""}return(r,n)=>{const B=P,M=N;return s(),a("article",U,[o("button",{type:"button",class:"inline-block bg-transparent border-0 p-0 text-left text-xs uppercase tracking-[0.35em] text-white/50 hover:text-white/70 transition cursor-pointer font-inherit",onClick:C}," ← 返回快照 "),o("div",J,[n[0]||(n[0]=o("p",{class:"text-xs uppercase tracking-[0.4em] text-white/40 mb-4"},"Snapshot",-1)),o("h1",Q,c(t(e)?.title),1),o("div",W,[o("span",null,c(D(t(e)?.date)),1),t(e)?.location?(s(),a("span",X,"· "+c(t(e)?.location),1)):i("",!0),t(f)!==null?(s(),a("span",Z,"· "+c(t(f))+" 次浏览",1)):i("",!0),t(g)!==null?(s(),a("span",tt," · "+c(t(g))+" 条评论 ",1)):i("",!0)]),t(e)?.summary?(s(),a("p",et,c(t(e)?.summary),1)):i("",!0),t(e)?.images&&t(e)?.images.length?(s(),a("div",st,[(s(!0),a(w,null,k(t(e).images,(m,d)=>(s(),a("div",{key:`${t(e)?._path}-img-${d}`,class:"flex items-start justify-center overflow-hidden"},[o("img",{src:m,alt:"snapshot",loading:d===0?"eager":"lazy",fetchpriority:d===0?"high":"auto",decoding:"async",class:"block h-auto w-full max-h-[32rem] max-w-[42rem] rounded-2xl border border-white/15 object-contain"},null,8,at)]))),128))])):i("",!0),t(e)?.tags?(s(),a("div",ot,[(s(!0),a(w,null,k(t(e).tags,m=>(s(),a("span",{key:m,class:"px-3 py-1 text-xs uppercase tracking-[0.2em] text-white/60 border border-white/10 rounded-full"},c(m),1))),128))])):i("",!0),o("div",nt,[t(y)?(s(),a("div",{key:0,innerHTML:t(y)},null,8,rt)):t(e)?(s(),H(B,{key:1,value:t(e)},null,8,["value"])):i("",!0)])]),o("div",ct,[n[1]||(n[1]=o("div",{class:"text-xs uppercase tracking-[0.35em] text-white/50 mb-4"}," Comments ",-1)),S(M)])])}}}),Ct=E(it,[["__scopeId","data-v-d9260165"]]);export{Ct as default};
