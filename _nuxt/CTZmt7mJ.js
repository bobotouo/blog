import{M as $,N as U,e as F,f as S,O as m,P,j as q,g as D,o as x,c as E,q as k,L as z}from"./BUJ_eH2L.js";import{s as I}from"./CljdUlt7.js";import{u as T}from"./Cwp8yiYm.js";const L=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],N=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",p=[];class H{_data=new _;_hash=new _([...L]);_nDataBytes=0;_minBufferSize=0;finalize(s){s&&this._append(s);const e=this._nDataBytes*8,t=this._data.sigBytes*8;return this._data.words[t>>>5]|=128<<24-t%32,this._data.words[(t+64>>>9<<4)+14]=Math.floor(e/4294967296),this._data.words[(t+64>>>9<<4)+15]=e,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(s,e){const t=this._hash.words;let a=t[0],o=t[1],n=t[2],l=t[3],u=t[4],h=t[5],f=t[6],i=t[7];for(let c=0;c<64;c++){if(c<16)p[c]=s[e+c]|0;else{const d=p[c-15],v=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,y=p[c-2],w=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;p[c]=v+p[c-7]+w+p[c-16]}const b=u&h^~u&f,C=a&o^a&n^o&n,A=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),j=(u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25),B=i+j+b+N[c]+p[c],O=A+C;i=f,f=h,h=u,u=l+B|0,l=n,n=o,o=a,a=B+O|0}t[0]=t[0]+a|0,t[1]=t[1]+o|0,t[2]=t[2]+n|0,t[3]=t[3]+l|0,t[4]=t[4]+u|0,t[5]=t[5]+h|0,t[6]=t[6]+f|0,t[7]=t[7]+i|0}_append(s){typeof s=="string"&&(s=_.fromUtf8(s)),this._data.concat(s),this._nDataBytes+=s.sigBytes}_process(s){let e,t=this._data.sigBytes/64;s?t=Math.ceil(t):t=Math.max((t|0)-this._minBufferSize,0);const a=t*16,o=Math.min(a*4,this._data.sigBytes);if(a){for(let n=0;n<a;n+=16)this._doProcessBlock(this._data.words,n);e=this._data.words.splice(0,a),this._data.sigBytes-=o}return new _(e,o)}}class _{words;sigBytes;constructor(s,e){s=this.words=s||[],this.sigBytes=e===void 0?s.length*4:e}static fromUtf8(s){const e=unescape(encodeURIComponent(s)),t=e.length,a=[];for(let o=0;o<t;o++)a[o>>>2]|=(e.charCodeAt(o)&255)<<24-o%4*8;return new _(a,t)}toBase64(){const s=[];for(let e=0;e<this.sigBytes;e+=3){const t=this.words[e>>>2]>>>24-e%4*8&255,a=this.words[e+1>>>2]>>>24-(e+1)%4*8&255,o=this.words[e+2>>>2]>>>24-(e+2)%4*8&255,n=t<<16|a<<8|o;for(let l=0;l<4&&e*8+l*6<this.sigBytes*8;l++)s.push(G.charAt(n>>>6*(3-l)&63))}return s.join("")}concat(s){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let e=0;e<s.sigBytes;e++){const t=s.words[e>>>2]>>>24-e%4*8&255;this.words[this.sigBytes+e>>>2]|=t<<24-(this.sigBytes+e)%4*8}else for(let e=0;e<s.sigBytes;e+=4)this.words[this.sigBytes+e>>>2]=s.words[e>>>2];this.sigBytes+=s.sigBytes}}function J(r){return new H().finalize(r).toBase64()}function g(r){return J(I(r))}function M(r,s,e){const[t={},a]=typeof s=="string"?[{},s]:[s,e],o=S(()=>m(r)),n=S(()=>m(t.key)||"$f"+g([a,typeof o.value=="string"?o.value:"",...K(t)]));if(!t.baseURL&&typeof o.value=="string"&&o.value[0]==="/"&&o.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:l,lazy:u,default:h,transform:f,pick:i,watch:c,immediate:b,getCachedData:C,deep:A,dedupe:j,timeout:B,...O}=t,d=$({...U,...O,cache:typeof t.cache=="boolean"?void 0:t.cache}),v={server:l,lazy:u,default:h,transform:f,pick:i,immediate:b,getCachedData:C,deep:A,dedupe:j,timeout:B,watch:c===!1?[]:[...c||[],d]};if(!b){let w=function(){v.immediate=!0};F(n,w,{flush:"sync",once:!0}),F([...c||[],d],w,{flush:"sync",once:!0})}return T(c===!1?n.value:n,(w,{signal:R})=>(t.$fetch||globalThis.$fetch)(o.value,{signal:R,...d}),v)}function K(r){const s=[m(r.method)?.toUpperCase()||"GET",m(r.baseURL)];for(const e of[r.query||r.params]){const t=m(e);if(!t)continue;const a={};for(const[o,n]of Object.entries(t))a[m(o)]=m(n);s.push(a)}if(r.body){const e=m(r.body);if(!e)s.push(g(e));else if(e instanceof ArrayBuffer)s.push(g(Object.fromEntries([...new Uint8Array(e).entries()].map(([t,a])=>[t,a.toString()]))));else if(e instanceof FormData){const t={};for(const a of e.entries()){const[o,n]=a;t[o]=n instanceof File?n.name:n}s.push(g(t))}else if(P(e))s.push(g($(e)));else try{s.push(g(e))}catch{console.warn("[useFetch] Failed to hash body",e)}}return s}const Y=q({__name:"Comments",setup(r){const s=k(null),e=k(!1),t=z(),a=t.public.giscusRepo||"",o=t.public.giscusRepoId||"",n=t.public.giscusCategory||"Announcements",l=t.public.giscusCategoryId||"",u=t.public.giscusTheme||"",h=u&&u!=="preferred_color_scheme"?u:"dark_dimmed",f=()=>{if(e.value||!s.value||!a||!o||!l)return;const i=document.createElement("script");i.src="https://giscus.app/client.js",i.async=!0,i.crossOrigin="anonymous",i.setAttribute("data-repo",a),i.setAttribute("data-repo-id",o),i.setAttribute("data-category",n),i.setAttribute("data-category-id",l),i.setAttribute("data-mapping","pathname"),i.setAttribute("data-reactions-enabled","1"),i.setAttribute("data-emit-metadata","0"),i.setAttribute("data-input-position","bottom"),i.setAttribute("data-theme",h),i.setAttribute("data-lang","zh-CN"),s.value.appendChild(i),e.value=!0};return D(()=>{s.value&&f()}),(i,c)=>(x(),E("div",{id:"comments",ref_key:"commentsContainer",ref:s,class:"my-8 rounded-2xl border border-white/10 bg-white/5 backdrop-blur-md p-4 md:p-6"},null,512))}}),Z=r=>{const s=k(null),t=z().public.statsBase||"",a=async()=>{if(!t)return;const n=JSON.stringify({path:r});if(navigator.sendBeacon){const l=new Blob([n],{type:"application/json"});navigator.sendBeacon(`${t}/track`,l);return}await fetch(`${t}/track`,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0})},o=async()=>{if(!t)return;const{data:n}=await M(`${t}/stats`,{query:{path:r},server:!1},"$tit_6EwdeP");n.value&&typeof n.value.views=="number"&&(s.value=n.value.views)};return D(()=>{a(),o()}),{views:s}},tt=r=>{const s=k(null),e=async()=>{const{data:t}=await M("/api/comments",{query:{path:r},server:!1},"$HyFBWF8tfB");t.value&&typeof t.value.comments=="number"&&(s.value=t.value.comments)};return D(()=>{e()}),{count:s}};export{Y as _,tt as a,Z as u};
