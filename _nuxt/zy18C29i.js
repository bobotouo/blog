import{O as z,P as M,e as S,f as $,Q as u,R as P,g as R,q as A,L as C}from"./CUPBOHsr.js";import{s as q}from"./BJ2ClxiI.js";import{u as x}from"./DVA3ssR6.js";const E=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],L=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",l=[];class I{_data=new w;_hash=new w([...E]);_nDataBytes=0;_minBufferSize=0;finalize(e){e&&this._append(e);const s=this._nDataBytes*8,t=this._data.sigBytes*8;return this._data.words[t>>>5]|=128<<24-t%32,this._data.words[(t+64>>>9<<4)+14]=Math.floor(s/4294967296),this._data.words[(t+64>>>9<<4)+15]=s,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(e,s){const t=this._hash.words;let a=t[0],o=t[1],i=t[2],h=t[3],c=t[4],d=t[5],y=t[6],B=t[7];for(let r=0;r<64;r++){if(r<16)l[r]=e[s+r]|0;else{const f=l[r-15],b=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,p=l[r-2],m=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;l[r]=b+l[r-7]+m+l[r-16]}const _=c&d^~c&y,k=a&o^a&i^o&i,j=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),D=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),v=B+D+_+L[r]+l[r],O=j+k;B=y,y=d,d=c,c=h+v|0,h=i,i=o,o=a,a=v+O|0}t[0]=t[0]+a|0,t[1]=t[1]+o|0,t[2]=t[2]+i|0,t[3]=t[3]+h|0,t[4]=t[4]+c|0,t[5]=t[5]+d|0,t[6]=t[6]+y|0,t[7]=t[7]+B|0}_append(e){typeof e=="string"&&(e=w.fromUtf8(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_process(e){let s,t=this._data.sigBytes/64;e?t=Math.ceil(t):t=Math.max((t|0)-this._minBufferSize,0);const a=t*16,o=Math.min(a*4,this._data.sigBytes);if(a){for(let i=0;i<a;i+=16)this._doProcessBlock(this._data.words,i);s=this._data.words.splice(0,a),this._data.sigBytes-=o}return new w(s,o)}}class w{words;sigBytes;constructor(e,s){e=this.words=e||[],this.sigBytes=s===void 0?e.length*4:s}static fromUtf8(e){const s=unescape(encodeURIComponent(e)),t=s.length,a=[];for(let o=0;o<t;o++)a[o>>>2]|=(s.charCodeAt(o)&255)<<24-o%4*8;return new w(a,t)}toBase64(){const e=[];for(let s=0;s<this.sigBytes;s+=3){const t=this.words[s>>>2]>>>24-s%4*8&255,a=this.words[s+1>>>2]>>>24-(s+1)%4*8&255,o=this.words[s+2>>>2]>>>24-(s+2)%4*8&255,i=t<<16|a<<8|o;for(let h=0;h<4&&s*8+h*6<this.sigBytes*8;h++)e.push(T.charAt(i>>>6*(3-h)&63))}return e.join("")}concat(e){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let s=0;s<e.sigBytes;s++){const t=e.words[s>>>2]>>>24-s%4*8&255;this.words[this.sigBytes+s>>>2]|=t<<24-(this.sigBytes+s)%4*8}else for(let s=0;s<e.sigBytes;s+=4)this.words[this.sigBytes+s>>>2]=e.words[s>>>2];this.sigBytes+=e.sigBytes}}function G(n){return new I().finalize(n).toBase64()}function g(n){return G(q(n))}function J(n,e,s){const[t={},a]=typeof e=="string"?[{},e]:[e,s],o=$(()=>u(n)),i=$(()=>u(t.key)||"$f"+g([a,typeof o.value=="string"?o.value:"",...K(t)]));if(!t.baseURL&&typeof o.value=="string"&&o.value[0]==="/"&&o.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:h,lazy:c,default:d,transform:y,pick:B,watch:r,immediate:_,getCachedData:k,deep:j,dedupe:D,timeout:v,...O}=t,f=z({...M,...O,cache:typeof t.cache=="boolean"?void 0:t.cache}),b={server:h,lazy:c,default:d,transform:y,pick:B,immediate:_,getCachedData:k,deep:j,dedupe:D,timeout:v,watch:r===!1?[]:[...r||[],f]};if(!_){let m=function(){b.immediate=!0};S(i,m,{flush:"sync",once:!0}),S([...r||[],f],m,{flush:"sync",once:!0})}return x(r===!1?i.value:i,(m,{signal:F})=>(t.$fetch||globalThis.$fetch)(o.value,{signal:F,...f}),b)}function K(n){const e=[u(n.method)?.toUpperCase()||"GET",u(n.baseURL)];for(const s of[n.query||n.params]){const t=u(s);if(!t)continue;const a={};for(const[o,i]of Object.entries(t))a[u(o)]=u(i);e.push(a)}if(n.body){const s=u(n.body);if(!s)e.push(g(s));else if(s instanceof ArrayBuffer)e.push(g(Object.fromEntries([...new Uint8Array(s).entries()].map(([t,a])=>[t,a.toString()]))));else if(s instanceof FormData){const t={};for(const a of s.entries()){const[o,i]=a;t[o]=i instanceof File?i.name:i}e.push(g(t))}else if(P(s))e.push(g(z(s)));else try{e.push(g(s))}catch{console.warn("[useFetch] Failed to hash body",s)}}return e}function U(){const e=C().public.statsBase;return e||(typeof window<"u"?`${window.location.origin}/api`:"")}const W=n=>{const e=A(null),s=async()=>{const a=U();if(!a)return;const o=JSON.stringify({path:n});if(navigator.sendBeacon){const i=new Blob([o],{type:"application/json"});navigator.sendBeacon(`${a}/track`,i);return}await fetch(`${a}/track`,{method:"POST",headers:{"Content-Type":"application/json"},body:o,keepalive:!0})},t=async()=>{const a=U();if(!a)return;const{data:o}=await J(`${a}/stats`,{query:{path:n},server:!1},"$tit_6EwdeP");o.value&&typeof o.value.views=="number"&&(e.value=o.value.views)};return R(()=>{s(),t()}),{views:e}};export{J as a,W as u};
