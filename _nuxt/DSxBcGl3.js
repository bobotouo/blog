import{g as c,q as u,L as f}from"./Og3GdUtk.js";function o(){const e=f().public.statsBase;return e||(typeof window<"u"?`${window.location.origin}/api`:"")}const l=a=>{const e=u(null),i=async()=>{const t=o();if(!t)return;const n=JSON.stringify({path:a});if(navigator.sendBeacon){const r=new Blob([n],{type:"application/json"});navigator.sendBeacon(`${t}/track`,r);return}await fetch(`${t}/track`,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0})},s=async()=>{const t=o();if(t)try{const n=await $fetch(`${t}/stats`,{query:{path:a},timeout:4e3});typeof n?.views=="number"&&(e.value=n.views)}catch{}};return c(()=>{const t=()=>{i(),s()};if("requestIdleCallback"in window){window.requestIdleCallback(()=>t(),{timeout:1500});return}window.setTimeout(t,700)}),{views:e}};export{l as u};
